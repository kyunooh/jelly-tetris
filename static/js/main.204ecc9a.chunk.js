(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{27:function(e,t,r){e.exports=r(43)},32:function(e,t,r){},33:function(e,t,r){},39:function(e,t,r){},40:function(e,t,r){},41:function(e,t,r){},42:function(e,t,r){},43:function(e,t,r){"use strict";r.r(t);var n=r(1),o=r.n(n),c=r(17),l=r.n(c),a=(r(32),r(33),r(8)),i=r(5),u=r(7),s=r(44),f="jelly-tetris/tick",d="jelly-tetris/rotate",m="jelly-tetris/drop",v="jelly-tetris/reset",g="jelly-tetris/hold",k=r(10),h=r(45),p=Object(h.a)(f),b=Object(h.a)("jelly-tetris/moveLeft"),B=Object(h.a)("jelly-tetris/moveRight"),j=Object(h.a)(d),y=Object(h.a)(m),O=Object(h.a)(v),w=Object(h.a)(g),E=Object(h.a)("jelly-tetris/playBgm"),x=Object(h.a)("jelly-tetris/pauseBgm"),N=new Audio("http://jellyms.kr/jelly-tetris/whoosh.wav"),L=function(e){var t=localStorage.getItem("jelly-tetris");return t?JSON.parse(t):{newBlock:!0,gameOver:!1,dropping:!1,hold:!1,canHold:!0,removedLines:0,levels:1,currentBlock:[],currentBlockNumber:-1,nextBlock:[],nextBlockNumber:-1,holdBlock:[],playBgm:!e||e.playBgm,temporaryHoldBlockNumber:0,currentBlockLocation:[0,0],grid:Array(16).fill(Array(10).fill(0))}},R={0:[[11,11,11,11]],1:[[12,12,12],[0,0,12]],2:[[13,13,13],[13,0,0]],3:[[14,14],[14,14]],4:[[15,15,15],[0,15,0]],5:[[16,16,0],[0,16,16]],6:[[0,17,17],[17,17,0]]},T=function(e){for(var t=!1,r=0;r<e.grid.length;r++){for(var n=0;n<e.grid[r].length;n++)if(e.grid[r][n]>10){e.currentBlockLocation=[r,n],t=!0;break}if(t)break}};function I(e,t,r,n,o){return t+r>=e.length||n+o>=e[0].length||e[t+r][n+o]}var A=function(e){N.play();for(var t=[],r=e.currentBlock.length,n=e.currentBlock[0].length,o=e.currentBlock,c=0;c<n;c++){for(var l=[],a=0;a<r;a++)l.push(o[r-(r-a-1)-1][n-c-1]);t.push(l)}return function e(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(n<-3){if(o>2)return;e(t,r,-1,o+1)}else if(o>2)n>0&&e(t,r,-1);else if(n>3)e(t,r,0,o+1);else{for(var c=H(t.grid),l=0;l<c.length;l++)for(var a=0;a<c[l].length;a++)c[l][a]>10&&(c[l][a]=0);for(var i=t.currentBlockLocation[0]+o,u=t.currentBlockLocation[1]+n,s=0;s<r.length;s++)for(var f=0;f<r[s].length;f++){if(I(c,s,i,f,u))return void e(t,r,n>=0?n+1:n-1,o);c[s+i][f+u]=r[s][f]}t.currentBlock=r,t.grid=Object(k.a)(c)}}(e,t),Object(i.a)({},e)},H=function(e){return e.map(function(e){return e.slice()})};function M(e,t,r,n){return e===t.grid.length-1||r[e+1][n]<10&&r[e+1][n]>0}var S,C=function e(t){localStorage.setItem("jelly-tetris",JSON.stringify(t)),function(e){var t=document.getElementById("bgm-audio");t&&(t.playbackRate=.96+.04*e.levels,e.playBgm?t.play():t.pause())}(t);var r=H(t.grid);if(t.newBlock)return function(e,t){if(0===t.currentBlock.length)t.currentBlockNumber=Math.floor(7*Math.random()),t.currentBlock=Object(k.a)(R[t.currentBlockNumber]),t.nextBlockNumber=Math.floor(7*Math.random()),t.nextBlock=Object(k.a)(R[t.nextBlockNumber]);else if(t.hold&&t.holdBlock.length>0)t.temporaryHoldBlockNumber=t.currentBlockNumber,t.currentBlock=Object(k.a)(t.holdBlock);else if(t.hold){t.temporaryHoldBlockNumber=t.currentBlockNumber,t.currentBlock=Object(k.a)(t.nextBlock),t.currentBlockNumber=t.nextBlockNumber,t.nextBlockNumber=Math.floor(7*Math.random());var r=R[t.nextBlockNumber];t.nextBlock=Object(k.a)(r)}else{t.currentBlock=Object(k.a)(t.nextBlock),t.currentBlockNumber=t.nextBlockNumber,t.nextBlockNumber=Math.floor(7*Math.random());var n=R[t.nextBlockNumber];t.nextBlock=Object(k.a)(n)}for(var o=0;o<t.currentBlock.length;o++)for(var c=0;c<t.currentBlock[o].length;c++)e[o][c+3]>0&&e[o][c+3]<10&&(t.gameOver=!0),e[o][c+3]=t.currentBlock[o][c]}(r,t),t.newBlock=!1,t.dropping=!1,t.hold||(t.canHold=!0),t.hold=!1,t.grid=r,T(t),Object(i.a)({},t);for(var n=r.length-1;n>=0;n--)for(var o=0;o<r[n].length;o++)if(r[n][o]>10){if(M(n,t,r,o)){r=H(t.grid),t.newBlock=!0;for(var c=0;c<r.length;c++)for(var l=r[c],a=!0,u=0;u<l.length;u++)l[u]&&l[u]>10&&(l[u]-=10),l[u]||(a=!1),a&&u===l.length-1&&J(r,c,t);return t.grid=r,e(t)}r[n+1][o]=r[n][o],r[n][o]=0}return t.grid=r,T(t),Object(i.a)({},t)},J=function(e,t,r){e.splice(t,1),e.unshift(Array(10).fill(0)),r.removedLines+=1,r.removedLines%8===0&&(clearInterval(r.reservedTick),r.levels+=1,r.reservedTick=setInterval(function(){p()},1e3*Math.pow(.85,r.levels)))},P=function(e){return e>10},W=Object(s.a)((S={},Object(u.a)(S,f,function(e){return C(e)}),Object(u.a)(S,"jelly-tetris/moveLeft",function(e){return function(e){for(var t=H(e.grid),r=!0,n=t.length-1;n>=0;n--)for(var o=t[n],c=0;c<o.length;c++)P(o[c])&&(0===o[c-1]?(t[n][c-1]=t[n][c],t[n][c]=0):r=!1);return r&&(e.grid=t),T(e),Object(i.a)({},e)}(e)}),Object(u.a)(S,"jelly-tetris/moveRight",function(e){return function(e){for(var t=H(e.grid),r=!0,n=t.length-1;n>=0;n--)for(var o=t[n],c=o.length-1;c>=0;c--)if(P(o[c]))if(0===o[c+1]){var l=t[n][c];t[n][c]=0,t[n][c+1]=l}else r=!1;return r&&(e.grid=t),T(e),Object(i.a)({},e)}(e)}),Object(u.a)(S,d,function(e){return A(e)}),Object(u.a)(S,m,function(e){return function(e){for(e.dropping=!0;e.dropping;)e=C(e);return Object(i.a)({},e)}(e)}),Object(u.a)(S,v,function(e){return function(e){return clearInterval(e.reservedTick),localStorage.setItem("jelly-tetris",""),L(e)}(e)}),Object(u.a)(S,g,function(e){return function(e){if(!e.canHold)return Object(i.a)({},e);e.canHold=!1,e.hold=!0;for(var t=0;t<e.grid.length;t++)for(var r=0;r<e.grid[t].length;r++)e.grid[t][r]>10&&(e.grid[t][r]=0);return e.newBlock=!0,(e=C(e)).holdBlock=R[e.temporaryHoldBlockNumber],e}(e)}),Object(u.a)(S,"jelly-tetris/playBgm",function(e){return function(e){return e.playBgm=!0,e}(e)}),Object(u.a)(S,"jelly-tetris/pauseBgm",function(e){return function(e){return e.playBgm=!1,e}(e)}),S),L()),D=function(e){return Object(a.c)(Object(i.a)({tetrisReducer:W},e))},K=r(25),_=r(12),G=r.n(_),U=r(16),X=G.a.mark(F),$=G.a.mark(Q),q=G.a.mark(V),z=function(e){return new Promise(function(t){return setTimeout(t,e)})};function F(){var e;return G.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(U.c)(function(e){return e.tetrisReducer.levels});case 2:return e=t.sent,t.next=5,z(1e3*Math.pow(.85,e));case 5:return t.next=7,Object(U.b)(p());case 7:case"end":return t.stop()}},X)}function Q(){return G.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(U.d)("WATCH_TICK",function(){return F()});case 2:case"end":return e.stop()}},$)}function V(){return G.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(U.a)([Q()]);case 2:case"end":return e.stop()}},q)}var Y=function(){var e=Object(K.a)(),t=Object(a.e)(D(),Object(a.d)(Object(a.a)(e)));return t.asyncReducers={},t.injectReducer=function(e,r){t.asyncReducers[e]=r,t.replaceReducer(D(t.asyncReducers))},e.run(V),t},Z=r(14);r(39),r(40);var ee=function(e){var t=e.grid,r=[];function n(e){for(var r=[],n=0;n<t[e].length;n++){var c="".concat(e,"-").concat(n);t[e][n]?r.push(o.a.createElement("span",{className:"cell fill-".concat(t[e][n]),key:c},"\xa0")):r.push(o.a.createElement("span",{className:"cell empty",key:c},"\xa0"))}return r}for(var c=0;c<t.length;c++)r.push(o.a.createElement("div",{className:"row",key:c},n(c)));return r},te=(r(41),function(){return o.a.createElement("div",{id:"game-over"},"Game Over")});var re=function(e){var t=e.grid;return e.tickTimer(e.levels),document.onkeydown=function(t){"ArrowLeft"===t.key&&e.moveLeft(),"ArrowRight"===t.key&&e.moveRight(),"ArrowDown"===t.key&&e.tick(),"ArrowUp"===t.key&&e.rotate()," "===t.key&&e.drop(),"Shift"===t.key&&e.hold()},o.a.createElement("div",{className:"play-view"},e.gameOver?o.a.createElement(te,null):o.a.createElement(ee,{grid:t}))},ne=Object(Z.b)(function(e){return Object(i.a)({},e.tetrisReducer)},function(e){return{tick:function(){return e(p())},moveLeft:function(){return e(b())},moveRight:function(){return e(B())},rotate:function(){return e(j())},drop:function(){return e(y())},tickTimer:function(t){return e({type:"WATCH_TICK",levels:t})},hold:function(){return e(w())}}})(function(e){return o.a.createElement(re,{tick:function(){e.tick()},moveLeft:function(){e.moveLeft()},moveRight:function(){e.moveRight()},rotate:function(){e.rotate()},drop:function(){e.drop()},tickTimer:function(t){e.tickTimer(t)},hold:function(){e.hold()},grid:e.grid,levels:e.levels,gameOver:e.gameOver,reservedTick:e.reservedTick})}),oe=(r(42),function(e){var t=function(e){for(var t=[[0,0,0,0,0],[0,0,0,0,0],[0,0,0,0,0],[0,0,0,0,0]],r=0;r<e.length;r++)for(var n=0;n<e[r].length;n++)t[r+1][n+1]=e[r][n];return t};return o.a.createElement("div",{id:"information-window"},o.a.createElement(ee,{grid:t(e.nextBlock)}),o.a.createElement("div",null,"NEXT"),o.a.createElement(ee,{grid:t(e.holdBlock)}),o.a.createElement("div",null,"HOLD"),o.a.createElement("div",{id:"removed-lines"},"Lines: ",e.removedLines),o.a.createElement("div",{id:"levels"},"Level: ",e.levels),o.a.createElement("button",{id:"prevent-reset",style:{width:"0px",height:"0px"}}),o.a.createElement("button",{className:"reset-button",onClick:e.reset},"Reset"),o.a.createElement("div",{id:"audio-panel"},o.a.createElement("audio",{id:"bgm-audio",controls:!0,onPause:e.pauseBgm,onPlay:e.playBgm,autoPlay:!0,loop:!0},o.a.createElement("source",{src:"http://jellyms.kr/jelly-tetris/tetris.ogg",type:"audio/ogg; codecs=vorbis"}))))}),ce=Object(Z.b)(function(e){return Object(i.a)({},e.tetrisReducer)},function(e){return{reset:function(){return e(O())},pauseBgm:function(){return e(x())},playBgm:function(){return e(E())}}})(function(e){return o.a.createElement(oe,{nextBlock:e.nextBlock,holdBlock:e.holdBlock,removedLines:e.removedLines,levels:e.levels,playBgm:function(){e.playBgm(),document.getElementById("prevent-reset").focus()},pauseBgm:function(){e.pauseBgm(),document.getElementById("prevent-reset").focus()},reset:function(){e.reset(),document.getElementById("prevent-reset").focus()}})}),le=Y();var ae=function(){return o.a.createElement(Z.a,{store:le},o.a.createElement("div",{className:"App"},o.a.createElement(ne,null),o.a.createElement(ce,null)))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(o.a.createElement(ae,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[27,1,2]]]);
//# sourceMappingURL=main.204ecc9a.chunk.js.map